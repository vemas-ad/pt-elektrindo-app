module.exports=[72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},60350,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(7291);function f(){let[a,f]=(0,c.useState)(""),[g,h]=(0,c.useState)(""),[i,j]=(0,c.useState)(!1),k=(0,d.useRouter)();(0,c.useEffect)(()=>{console.log("SUPABASE URL:","https://qpqjlpqxxluedxgzzatp.supabase.co/"),console.log("SUPABASE KEY:","ADA")},[]),(0,c.useEffect)(()=>{(async()=>{let{data:a}=await e.supabase.auth.getSession();a.session&&k.push("/projects")})()},[k]);let l=async b=>{b.preventDefault(),j(!0);try{if(!a.endsWith("@gmail.com")){alert("Hanya email @gmail.com yang diperbolehkan."),j(!1);return}if(!g.trim()){alert("Password harus diisi."),j(!1);return}let{data:b,error:c}=await e.supabase.auth.signInWithPassword({email:a,password:g});if(c&&c.message.includes("Invalid login credentials")){let b="user";a.includes("admin")||a.includes("master")?b="master":(a.includes("silver")||a.includes("engineer"))&&(b="silver");let{error:c}=await e.supabase.auth.signUp({email:a,password:g,options:{data:{role:b}}});if(c){alert("Pendaftaran gagal: "+c.message),j(!1);return}let{error:d}=await e.supabase.auth.signInWithPassword({email:a,password:g});if(d){alert("Login gagal setelah pendaftaran"),j(!1);return}}else if(c){alert("Login gagal: "+c.message),j(!1);return}let{data:d}=await e.supabase.auth.getUser(),f="user";d?.user?.user_metadata?.role?f=d.user.user_metadata.role:a.includes("admin")||a.includes("master")?f="master":(a.includes("silver")||a.includes("engineer"))&&(f="silver"),localStorage.setItem("userEmail",a),localStorage.setItem("userRole",f),localStorage.setItem("userProfile",`https://ui-avatars.com/api/?name=${encodeURIComponent(a.split("@")[0])}&background=random`);try{await e.supabase.from("users").upsert({email:a,role:f,last_login:new Date().toISOString(),created_at:new Date().toISOString()},{onConflict:"email"})}catch(a){console.warn("Error upsert user:",a)}console.log("Login berhasil dengan role:",f),"master"===f?k.push("/dashboard/master"):"silver"===f?k.push("/dashboard/silver"):k.push("/projects")}catch(a){console.error("Login error:",a),alert("Terjadi kesalahan sistem.")}finally{j(!1)}};return(0,b.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-100",children:(0,b.jsxs)("form",{onSubmit:l,className:"w-full max-w-sm bg-white p-6 rounded shadow",children:[(0,b.jsxs)("div",{className:"mb-4 text-center",children:[(0,b.jsx)("img",{src:"/logo-eltama.png",className:"mx-auto mb-2",onError:a=>{let b=a.currentTarget.parentElement;b&&(b.innerHTML='<div class="w-full h-full bg-blue-600 flex items-center justify-center text-white font-bold">PT EUI</div>')}}),(0,b.jsx)("h1",{className:"font-bold",children:"PT ELEKTRINDO UTAMA INDONESIA"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"MECHANICAL - ELECTRICAL - FIRE PROTECTION"})]}),(0,b.jsxs)("div",{className:"mb-3",children:[(0,b.jsx)("input",{type:"email",value:a,onChange:a=>f(a.target.value),placeholder:"Email Anda (harus @gmail.com)",className:"w-full border p-2 rounded",required:!0}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Contoh: user@gmail.com"})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("input",{type:"password",value:g,onChange:a=>h(a.target.value),placeholder:"Password Anda",className:"w-full border p-2 rounded",required:!0}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Password akan dibuat secara otomatis saat pertama kali login"})]}),(0,b.jsxs)("div",{className:"mb-4 text-xs text-gray-600",children:[(0,b.jsx)("p",{className:"font-semibold",children:"Informasi:"}),(0,b.jsxs)("ul",{className:"list-disc pl-4 mt-1",children:[(0,b.jsx)("li",{children:"Email harus menggunakan @gmail.com"}),(0,b.jsx)("li",{children:"Sistem akan membuat akun otomatis untuk pertama kali"}),(0,b.jsx)("li",{children:"Role akan ditentukan berdasarkan email"})]})]}),(0,b.jsx)("button",{disabled:i,className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 disabled:opacity-50",children:i?"Memproses...":"Login / Buat Akun"}),(0,b.jsxs)("div",{className:"mt-4 text-xs text-gray-500 text-center",children:[(0,b.jsxs)("p",{children:["Â© ",new Date().getFullYear()," PT. Elektindo Utama Indonesia"]}),(0,b.jsx)("p",{children:"Project Management System v1.0"})]})]})})}a.s(["default",()=>f])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__6f4da6d9._.js.map